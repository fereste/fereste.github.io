(this.webpackJsonpgastos=this.webpackJsonpgastos||[]).push([[0],{103:function(e,t,n){},114:function(e,t,n){"use strict";n.r(t);var a=n(4),r=n(0),c=n.n(r),i=n(11),o=n.n(i),s=(n(103),n(91)),u=n(166),l=n(167),d=n(56),j=n(12),b=n(16),p=n(31),h=n(15),O=n(150),f=n(173),v=n(157),g=n(169),m=n(36),x=n.n(m),w=n(63);function C(e){return null===e||void 0===e||0===e.length}function y(e){return decodeURIComponent(escape(window.atob(e)))}var k=y("OTE5NDY5MjYwODgzLXNnMmduOHZtNHBmOWRudThkYm9tZDQzbzNiZzZrczhjLmFwcHMuZ29vZ2xldXNlcmNvbnRlbnQuY29t"),I=y("QUl6YVN5Q2ktOV9jb2tpMHdOVXlDcHd6YlFOUk8xTm5wdFdkNHpZ"),N=["https://sheets.googleapis.com/$discovery/rest?version=v4"],S=y("MUlQX3pyTDgxRWoyVENMRDVxSVlXZFA4ZkZrM3hZWXZKXy1rb2daV0FhOUU=");function E(){var e,t,n,a;return null===(e=window.gapi.auth2)||void 0===e||null===(t=e.getAuthInstance())||void 0===t||null===(n=t.currentUser.get())||void 0===n||null===(a=n.getBasicProfile())||void 0===a?void 0:a.getGivenName()}function A(){return new Promise((function(e,t){window.gapi.load("client:auth2",function(e,t){return function(n){window.gapi.client.init({apiKey:I,clientId:k,discoveryDocs:N,scope:"https://www.googleapis.com/auth/spreadsheets"}).then((function(){window.gapi.auth2.getAuthInstance().isSignedIn.listen(n),n&&n(window.gapi.auth2.getAuthInstance().isSignedIn.get()),e()}),(function(e){t(e)}))}}(e,t))}))}var M=n(80),R=function e(t,n,a,r,c){Object(M.a)(this,e),this.description=void 0,this.category=void 0,this.amount=void 0,this.date=void 0,this.author=void 0,this.description=t,this.category=n,this.amount=a,this.date=r,this.author=c};function F(){return(F=Object(w.a)(x.a.mark((function e(t,n,a){var r,c,i,o,s,u,l;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],C(t)&&r.push("descripci\xf3n"),C(n)&&r.push("categor\xeda"),C(a)&&r.push("cantidad"),!(r.length>0)){e.next=9;break}throw c=1===r.length?"tiene":"tienen",i=(i="".concat(r.join(", "))).slice(0,1).toLocaleUpperCase().concat(i.slice(1)),new Error("".concat(i," ").concat(c," error."));case 9:return e.prev=9,o=a.replace(".",","),s=(new Date).toLocaleString("es-AR",{year:"numeric",month:"2-digit",day:"2-digit"}),u=E(),l="",l="Fernando"===u?"Fer":"Mariela"===u?"Maru":u,e.next=17,window.gapi.client.sheets.spreadsheets.values.append({spreadsheetId:"1IP_zrL81Ej2TCLD5qIYWdP8fFk3xYYvJ_-kogZWAa9E",range:"Gastos!A2:E",valueInputOption:"USER_ENTERED",resource:{values:[[t,n,o,s,l]]}});case 17:e.next=22;break;case 19:throw e.prev=19,e.t0=e.catch(9),new Error(e.t0);case 22:case"end":return e.stop()}}),e,null,[[9,19]])})))).apply(this,arguments)}function D(){return(D=Object(w.a)(x.a.mark((function e(){var t,n,a,r,c,i,o,s=arguments;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:30,e.prev=1,e.next=4,window.gapi.client.sheets.spreadsheets.values.get({spreadsheetId:S,range:"Gastos!lastRow"});case 4:n=e.sent,e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(1),new Error("Fall\xf3 request: no se pudo obtener el n\xfamero de la \xfaltima fila con datos.");case 10:if(a=n.result.values){e.next=13;break}throw new Error("No se pudo obtener el n\xfamero de la \xfaltima fila con datos.");case 13:return r=a[0][0],c=r-t+1,e.prev=15,e.next=18,window.gapi.client.sheets.spreadsheets.values.get({spreadsheetId:S,range:"Gastos!A".concat(c,":E").concat(r)});case 18:i=e.sent,e.next=24;break;case 21:throw e.prev=21,e.t1=e.catch(15),new Error("Fall\xf3 request: no se pudieron obtener los \xfaltimso ".concat(t," datos."));case 24:if(o=i.result.values){e.next=27;break}throw new Error("No se pudieron obtener los \xfaltimso ".concat(t," datos."));case 27:return e.abrupt("return",o.map((function(e){return new R(e[0],e[1],e[2],e[3],e[4])})));case 28:case"end":return e.stop()}}),e,null,[[1,7],[15,21]])})))).apply(this,arguments)}var T=n(153),W=n(155),Z=n(156),U=n(84),L=n.n(U),P=n(85),z=n.n(P),G=n(86),Y=n.n(G),H=n(65),V=n(64),B=n(3),X=Object(O.a)((function(e){return{buttonContainer:{display:"flex",justifyContent:"center"},wrapper:{margin:e.spacing(1),position:"absolute"},success:{backgroundColor:H.a[500],"&:hover":{backgroundColor:H.a[700]}},failure:{backgroundColor:V.a[500],"&:hover":{backgroundColor:V.a[700]}},progress:{color:H.a[500],position:"absolute",top:-6,left:-6,zIndex:1},iconWrapper:{display:"flex",alignItems:"center",justifyContent:"center","& *":{position:"absolute"}}}})),q=0,Q=1,_=2,J=3,K=function(e){var t,n=e.onClick,c=e.promise,i=X(),o=Object(r.useState)(q),s=Object(b.a)(o,2),u=s[0],l=s[1];return Object(r.useEffect)((function(){c?(l(Q),c.then((function(){l(_),setTimeout((function(){l(q)}),2e3)})).catch((function(){l(J),setTimeout((function(){l(q)}),2e3)}))):l(q)}),[c]),Object(a.jsx)("div",{className:i.buttonContainer,children:Object(a.jsxs)("div",{className:i.wrapper,children:[Object(a.jsx)(T.a,{"aria-label":"Guardar",className:Object(B.a)((t={},Object(p.a)(t,i.success,u===_),Object(p.a)(t,i.failure,u===J),t)),color:"primary",onClick:n,disabled:u===Q,children:Object(a.jsxs)("div",{className:i.iconWrapper,children:[Object(a.jsx)(W.a,{in:u===q||u===Q,appear:!1,children:Object(a.jsx)(L.a,{})}),Object(a.jsx)(W.a,{in:u===_,style:{transitionDelay:u===_?"200ms":"0ms"},children:Object(a.jsx)(z.a,{})}),Object(a.jsx)(W.a,{in:u===J,style:{transitionDelay:u===J?"200ms":"0ms"},children:Object(a.jsx)(Y.a,{})})]})}),u===Q&&Object(a.jsx)(Z.a,{size:68,className:i.progress})]})})},$=n(158),ee=c.a.createContext(void 0);ee.displayName="AuthContext";var te=function(e){var t=e.children,n=Object(r.useState)(!1),c=Object(b.a)(n,2),i=c[0],o=c[1],s=Object(r.useState)(void 0),u=Object(b.a)(s,2),l=u[0],d=u[1],j=Object(r.useCallback)((function(){var e="Hubo un error con el logueo. Estos programadores son todos iguales. Preguntale a Fer si lo puede arreglar.";return window.gapi.auth2.getAuthInstance().signIn().then((function(){o(!0)}),(function(){d(e)})).catch((function(){d(e)}))}),[]),p=Object(r.useCallback)((function(){return window.gapi.auth2.getAuthInstance().signOut().then((function(){o(!1)}))}),[]);Object(r.useEffect)((function(){A().then((function(){o(window.gapi.auth2.getAuthInstance().isSignedIn.get())})).catch((function(e){"idpiframe_initialization_failed"===e.error?d("Tu URL no est\xe1 admitida por Google. URL: ".concat(window.location.href)):d(JSON.stringify(e))}))}),[]);var h=Object(r.useMemo)((function(){return{isSignedIn:i,setIsSignedIn:o,error:l,signIn:j,signOut:p}}),[l,j,p,i]);return Object(a.jsx)(ee.Provider,{value:h,children:t})};function ne(){var e=c.a.useContext(ee);if(void 0===e)throw new Error("useAuthContext tiene que estar dentro de un AuthContextProvider");return e}var ae=Object(O.a)((function(e){return{root:{margin:e.spacing(3),textAlign:"center"},spacing:{marginBottom:e.spacing(2)},button:{marginTop:e.spacing(2)},errorMessage:{color:e.palette.error.main}}})),re=function(e){var t=e.onSignedIn,n=ae(),c=ne(),i=Object(r.useState)(""),o=Object(b.a)(i,2),s=o[0],u=o[1],l=Object(r.useCallback)((function(){c.signIn().then((function(){t&&t()}))}),[c,t]);return Object(r.useEffect)((function(){var e;u(null!==(e=c.error)&&void 0!==e?e:"")}),[c.error]),Object(a.jsxs)("div",{className:n.root,children:[Object(a.jsx)(v.a,{className:n.spacing,variant:"h4",children:"Oops! :("}),Object(a.jsx)(v.a,{className:n.spacing,variant:"body1",children:"Ten\xe9s que loguearte para poder usar la app"}),Object(a.jsx)(v.a,{className:n.errorMessage,variant:"body1",children:s}),Object(a.jsx)($.a,{className:n.button,color:"primary",onClick:l,children:"Loguearme con Google"})]})},ce=n(62),ie=n(87),oe=function(e){var t=e.inputRef,n=void 0===t?void 0:t,c=e.onChange,i=void 0===c?void 0:c,o=e.value,s=void 0===o?void 0:o,u=Object(ce.a)(e,["inputRef","onChange","value"]),l=Object(r.useState)(""),d=Object(b.a)(l,2),j=d[0],p=d[1],O=Object(r.useRef)(""),f=Object(r.useCallback)((function(e){p(e.value),O.current=e.value}),[]),v=Object(r.useCallback)((function(e){e.target.value=O.current,i&&i(e)}),[i]);return Object(r.useEffect)((function(){p(null!==s&&void 0!==s?s:"")}),[s]),Object(a.jsx)(ie.a,Object(h.a)(Object(h.a)({},u),{},{getInputRef:n,onValueChange:f,onChange:v,thousandSeparator:".",decimalSeparator:",",decimalScale:2,isNumericString:!0,allowNegative:!1,prefix:"$ ",value:j}))},se=n(159),ue=n(171),le=n(168),de=n(170),je=["Casa","Supermercado","Farmacia","Electr\xf3nica","Gustos","Auto","Streaming","Otros","Maru"].sort(),be=function(e){var t=e.fullWidth,n=Object(ce.a)(e,["fullWidth"]);return Object(a.jsxs)(se.a,{fullWidth:t,children:[Object(a.jsx)(ue.a,{id:"category-select-label",children:"Categor\xeda"}),Object(a.jsx)(le.a,Object(h.a)(Object(h.a)({labelId:"category-select-label",label:"Categor\xeda"},n),{},{children:je.map((function(e){return Object(a.jsx)(de.a,{value:e,children:e},"itCat".concat(e))}))}))]})},pe=Object(O.a)((function(e){return{input:{margin:e.spacing(3)},buttonContainer:{display:"flex",justifyContent:"center"},form:{},error:{color:e.palette.error.main,textAlign:"center",marginBottom:e.spacing(1)}}})),he={description:{value:"",error:!1},category:{value:"",error:!1},amount:{value:"",error:!1}};function Oe(e,t){if("reset"===t.action)return he;if(void 0!==t.name){if("update"===t.action&&"string"===typeof t.value)return Object(h.a)(Object(h.a)({},e),{},Object(p.a)({},t.name,Object(h.a)(Object(h.a)({},e[t.name]),{},{value:t.value})));if("validate"===t.action&&"boolean"===typeof t.value)return Object(h.a)(Object(h.a)({},e),{},Object(p.a)({},t.name,Object(h.a)(Object(h.a)({},e[t.name]),{},{error:t.value})))}return e}var fe=function(){var e=pe(),t=ne(),n=Object(r.useReducer)(Oe,he),c=Object(b.a)(n,2),i=c[0],o=c[1],s=Object(r.useState)(),u=Object(b.a)(s,2),l=u[0],d=u[1],j=Object(r.useState)(""),p=Object(b.a)(j,2),O=p[0],m=p[1],x=Object(r.useRef)([]),w=Object(r.useState)([]),y=Object(b.a)(w,2),k=y[0],I=y[1],N=Object(r.useCallback)((function(e){var t=e.target,n=t.name,a=t.value;o({action:"update",name:n,value:a}),o({action:"validate",name:n,value:!1})}),[o]),S=Object(r.useCallback)((function(){var e=!1;if(Object.keys(i).forEach((function(t){var n=C(i[t].value);n&&(e=!0),o({action:"validate",name:t,value:n})})),e)d(new Promise((function(e,t){t()})));else{var t=function(e,t,n){return F.apply(this,arguments)}(i.description.value,i.category.value,i.amount.value);t.then((function(){o({action:"reset"})})).catch((function(){m("Hubo un problema guardando los datos.")})),d(t)}}),[i]),E=Object(r.useCallback)((function(){t.setIsSignedIn(!0)}),[t]);return Object(r.useEffect)((function(){t.isSignedIn&&function(){return D.apply(this,arguments)}().then((function(e){x.current=e,I(e.filter((function(e,t,n){return n.findIndex((function(t){return t.description===e.description}))===t})).reverse())}))}),[t.isSignedIn]),t.isSignedIn?Object(a.jsxs)("div",{children:[Object(a.jsxs)("form",{className:e.form,children:[Object(a.jsx)("div",{className:e.input,children:Object(a.jsx)(g.a,{renderInput:function(e){return Object(a.jsx)(f.a,Object(h.a)(Object(h.a)({},e),{},{label:"Descripci\xf3n",name:"description",fullWidth:!0,value:i.description.value,onChange:N,error:i.description.error}))},getOptionLabel:function(e){return null===e||void 0===e?void 0:e.description},options:k,clearOnBlur:!1})}),Object(a.jsx)("div",{className:e.input,children:Object(a.jsx)(be,{label:"Categor\xeda",name:"category",fullWidth:!0,value:i.category.value,onChange:N,error:i.category.error})}),Object(a.jsx)("div",{className:e.input,children:Object(a.jsx)(f.a,{label:"Cantidad",name:"amount",fullWidth:!0,value:i.amount.value,onChange:N,error:i.amount.error,InputProps:{inputComponent:oe}})})]}),Object(a.jsx)(v.a,{className:e.error,component:"div",variant:"body2",children:O}),Object(a.jsx)(K,{onClick:S,promise:l})]}):Object(a.jsx)(re,{onSignedIn:E})},ve=function(){var e=Object(j.f)();return Object(r.useEffect)((function(){setTimeout((function(){e.push("/")}),3e3)}),[e]),Object(a.jsx)("div",{children:"404 - P\xe1gina no encontrada Redirigiendo al inicio..."})},ge=function(){return Object(a.jsx)("div",{children:"Ac\xe1 van a aparecer gr\xe1ficos lindos."})},me=n(164),xe=n(165),we=n(163),Ce=n(90),ye=n.n(Ce),ke=n(89),Ie=n.n(ke),Ne=Object(O.a)((function(){return{title:{flexGrow:1}}})),Se=function(){var e=Ne(),t=Object(j.f)(),n=ne(),c=Object(r.useCallback)((function(){t.push("/stats")}),[t]),i=Object(r.useCallback)((function(){n.signOut()}),[n]);return Object(a.jsx)(me.a,{position:"static",children:Object(a.jsxs)(xe.a,{children:[Object(a.jsx)(v.a,{variant:"h6",className:e.title,children:"Nuevo gasto"}),Object(a.jsx)(we.a,{"aria-label":"Estad\xedsticas",color:"inherit",onClick:c,children:Object(a.jsx)(Ie.a,{})}),Object(a.jsx)(we.a,{"aria-label":"Usuario",color:"inherit",onClick:i,children:Object(a.jsx)(ye.a,{})})]})})},Ee=Object(s.a)({palette:{type:"light"},typography:{},props:{MuiButton:{variant:"contained"},MuiFormControl:{variant:"outlined"},MuiSelect:{variant:"outlined"},MuiTextField:{variant:"outlined"}}}),Ae=function(){return Object(a.jsx)("div",{children:Object(a.jsxs)(u.a,{theme:Ee,children:[Object(a.jsx)(l.a,{}),Object(a.jsx)(te,{children:Object(a.jsxs)(d.a,{basename:"/gastos",children:[Object(a.jsx)(Se,{}),Object(a.jsxs)(j.c,{children:[Object(a.jsx)(j.a,{exact:!0,path:"/",children:Object(a.jsx)(fe,{})}),Object(a.jsx)(j.a,{exact:!0,path:"/unlogged",children:Object(a.jsx)(re,{})}),Object(a.jsx)(j.a,{exact:!0,path:"/stats",children:Object(a.jsx)(ge,{})}),Object(a.jsx)(j.a,{path:"*",children:Object(a.jsx)(ve,{})})]})]})})]})})};o.a.render(Object(a.jsx)(c.a.StrictMode,{children:Object(a.jsx)(Ae,{})}),document.getElementById("root"))}},[[114,1,2]]]);
//# sourceMappingURL=main.8d400313.chunk.js.map